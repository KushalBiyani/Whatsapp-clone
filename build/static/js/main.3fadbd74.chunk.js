(this["webpackJsonpmy-whatsapp"]=this["webpackJsonpmy-whatsapp"]||[]).push([[0],{49:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){},84:function(e,t,a){},86:function(e,t,a){"use strict";a.r(t);var c=a(2),s=a.n(c),n=a(29),i=a.n(n),r=(a(67),a(68),a(13)),o=a(107),d=a(99),j=a(103),l=a(104),u=a(105),h=a(42),b=a.n(h),m=(a(49),a(69),a(100)),O=a(101),p=a(102),x=(a(70),a(28)),f=x.a.initializeApp({apiKey:"AIzaSyDNdMRue_sxo4B6kwb4dFk2oY2GNvrgphI",authDomain:"my-whatsapp-aec72.firebaseapp.com",projectId:"my-whatsapp-aec72",storageBucket:"my-whatsapp-aec72.appspot.com",messagingSenderId:"283307162217",appId:"1:283307162217:web:1f1452b6e7227d51e400f8",measurementId:"G-0222V19JY6"}),v=f.firestore(),g=f.auth(),N=(new x.a.auth.GoogleAuthProvider,v),S=a(25),y=a(3);var _=function(e){var t,a,s=e.userid,n=e.roomid,i=e.name,d=e.addNewChat,j=e.profileImage,l=e.currentUser,u=Object(c.useState)(""),h=Object(r.a)(u,2),b=h[0],m=h[1],O=Object(c.useState)(""),p=Object(r.a)(O,2),x=p[0],f=p[1];return Object(c.useEffect)((function(){n?N.collection("rooms").doc(n).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){f(e.docs.map((function(e){return e.data()})))})):s&&N.collection("users").doc(s).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){f(e.docs.map((function(e){return e.data()})))}))}),[n,s]),Object(c.useEffect)((function(){m(Math.floor(5e3*Math.random()))}),[]),d?Object(y.jsx)("div",{onClick:function(){var e=prompt("Please Enter Name for Chat");e&&N.collection("rooms").add({name:e})},className:"sidebarChat",children:Object(y.jsx)("h3",{className:"add-new-chat-title",children:"Add New Chat"})}):s?Object(y.jsx)(S.b,{to:"/users/".concat(l,"/").concat(s),children:Object(y.jsxs)("div",{className:"sidebarChat",children:[Object(y.jsx)(o.a,{src:j}),Object(y.jsxs)("div",{className:"sidebarChat_info",children:[Object(y.jsx)("h2",{children:i}),Object(y.jsx)("p",{children:null===(t=x[0])||void 0===t?void 0:t.message})]})]})},s):n?Object(y.jsx)(S.b,{to:"/rooms/".concat(n),children:Object(y.jsxs)("div",{className:"sidebarChat",children:[Object(y.jsx)(o.a,{src:"https://avatars.dicebear.com/api/human/".concat(b,".svg")}),Object(y.jsxs)("div",{className:"sidebarChat_info",children:[Object(y.jsx)("h2",{children:i}),Object(y.jsx)("p",{children:null===(a=x[0])||void 0===a?void 0:a.message})]})]})},n):void 0},w=a(56),C=s.a.createContext();function I(){return Object(c.useContext)(C)}function U(e){var t=e.children,a=Object(c.useState)(),s=Object(r.a)(a,2),n=s[0],i=s[1],o=Object(c.useState)(!0),d=Object(r.a)(o,2),j=d[0],l=d[1];Object(c.useEffect)((function(){return g.onAuthStateChanged((function(e){i(e),l(!1)}))}),[]);var u={currentUser:n,logout:function(){return g.signOut()},signInWithGoogle:function(){var e=new w.a.auth.GoogleAuthProvider;return g.signInWithPopup(e).then((function(e){N.collection("users").doc(e.user.uid).set({name:e.user.displayName,uid:e.user.uid,profileUrl:e.user.photoURL,createdAt:new Date})}))}};return Object(y.jsx)(C.Provider,{value:u,children:!j&&t})}var k=function(e){var t=Object(c.useState)([]),a=Object(r.a)(t,2),s=a[0],n=a[1],i=Object(c.useState)([]),l=Object(r.a)(i,2),u=l[0],h=l[1],b=I().currentUser;return Object(c.useEffect)((function(){var e=N.collection("rooms").onSnapshot((function(e){return n(e.docs.map((function(e){return{id:e.id,data:e.data()}})))})),t=N.collection("users").onSnapshot((function(e){return h(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e(),t()}}),[]),Object(y.jsxs)("div",{className:"sidebar",children:[Object(y.jsxs)("div",{className:"sidebar_header",children:[Object(y.jsx)(o.a,{src:null===b||void 0===b?void 0:b.photoURL}),Object(y.jsxs)("div",{className:"sidebar_headerRight",children:[Object(y.jsx)(d.a,{children:Object(y.jsx)(m.a,{})}),Object(y.jsx)(d.a,{children:Object(y.jsx)(O.a,{})}),Object(y.jsx)(d.a,{children:Object(y.jsx)(p.a,{})})]})]}),Object(y.jsx)("div",{className:"sidebar_search",children:Object(y.jsxs)("div",{className:"sidebar_searchContainer",children:[Object(y.jsx)(j.a,{}),Object(y.jsx)("input",{type:"text",placeholder:"Search or start new chat"})]})}),Object(y.jsxs)("div",{className:"sidebar_chats",children:[Object(y.jsx)(_,{addNewChat:!0}),u.map((function(e){return b.uid!==e.id&&Object(y.jsx)(_,{userid:e.id,name:e.data.name,profileImage:e.data.profileUrl,currentUser:b.uid},e.id)})),s.map((function(e){return Object(y.jsx)(_,{roomid:e.id,name:e.data.name},e.id)}))]})]})},D=a(10);var E=function(){var e,t,a=Object(c.useState)(""),s=Object(r.a)(a,2),n=s[0],i=s[1],h=Object(c.useState)(""),m=Object(r.a)(h,2),O=m[0],p=m[1],f=Object(D.h)().roomId,v=Object(c.useState)(""),g=Object(r.a)(v,2),S=g[0],_=g[1],w=Object(c.useState)([]),C=Object(r.a)(w,2),U=C[0],E=C[1],A=I(),M=A.currentUser,T=A.logout;return Object(c.useEffect)((function(){f&&(N.collection("rooms").doc(f).onSnapshot((function(e){_(e.data().name)})),N.collection("rooms").doc(f).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){E(e.docs.map((function(e){return e.data()})))})))}),[f]),Object(c.useEffect)((function(){p(Math.floor(5e3*Math.random()))}),[f]),Object(y.jsxs)("div",{className:"app_body",children:[Object(y.jsx)(k,{}),Object(y.jsxs)("div",{className:"chat",children:[Object(y.jsxs)("div",{className:"chat_header",children:[Object(y.jsx)(o.a,{src:"https://avatars.dicebear.com/api/human/".concat(O,".svg")}),Object(y.jsxs)("div",{className:"chat_headerInfo",children:[Object(y.jsx)("h3",{className:"chat-room-name",children:S}),Object(y.jsxs)("p",{className:"chat-room-last-seen",children:["Last seen "," ",new Date(null===(e=U[U.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()]})]}),Object(y.jsxs)("div",{className:"chat_headerRight",children:[Object(y.jsx)(d.a,{children:Object(y.jsx)(j.a,{})}),Object(y.jsx)(d.a,{children:Object(y.jsx)(l.a,{})}),Object(y.jsx)("button",{onClick:T,children:"Logout"})]})]}),Object(y.jsx)("div",{className:"chat_body",children:U.map((function(e){var t;return Object(y.jsxs)("p",{className:"chat_message ".concat(e.name===M.displayName&&"chat_receiver"),children:[Object(y.jsx)("span",{className:"chat_name",children:e.name}),e.message,Object(y.jsx)("span",{className:"chat_timestemp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]},e.timestamp)}))}),Object(y.jsxs)("div",{className:"chat_footer",children:[Object(y.jsx)(u.a,{}),Object(y.jsxs)("form",{children:[Object(y.jsx)("input",{value:n,onChange:function(e){return i(e.target.value)},type:"text",placeholder:"Type a message"}),Object(y.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),N.collection("rooms").doc(f).collection("messages").add({message:n,name:M.displayName,timestamp:x.a.firestore.FieldValue.serverTimestamp()}),i("")},children:" Send a Message"})]}),Object(y.jsx)(b.a,{})]})]})]})};var A=function(){var e,t,a=Object(c.useState)(""),s=Object(r.a)(a,2),n=s[0],i=s[1],h=Object(D.h)(),m=h.userId,O=h.senderId,p=Object(c.useState)(""),f=Object(r.a)(p,2),v=f[0],g=f[1],S=Object(c.useState)([]),_=Object(r.a)(S,2),w=_[0],C=_[1],U=I(),E=U.currentUser,A=U.logout;return Object(c.useEffect)((function(){m&&(N.collection("users").doc(m).onSnapshot((function(e){g(e.data())})),N.collection("messages").where("uid1","in",[m,O]).orderBy("timestamp","asc").onSnapshot((function(e){var t=[];e.forEach((function(e){(e.data().uid1===m&&e.data().uid2===O||e.data().uid1===O&&e.data().uid2===m)&&t.push(e.data())})),C(t)})))}),[m,O]),Object(y.jsxs)("div",{className:"app_body",children:[Object(y.jsx)(k,{}),Object(y.jsxs)("div",{className:"chat",children:[Object(y.jsxs)("div",{className:"chat_header",children:[Object(y.jsx)(o.a,{src:v.profileUrl}),Object(y.jsxs)("div",{className:"chat_headerInfo",children:[Object(y.jsx)("h3",{className:"chat-room-name",children:v.name}),Object(y.jsxs)("p",{className:"chat-room-last-seen",children:["Last seen "," ",new Date(null===(e=w[w.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()]})]}),Object(y.jsxs)("div",{className:"chat_headerRight",children:[Object(y.jsx)(d.a,{children:Object(y.jsx)(j.a,{})}),Object(y.jsx)(d.a,{children:Object(y.jsx)(l.a,{})}),Object(y.jsx)("button",{onClick:A,children:"Logout"})]})]}),Object(y.jsx)("div",{className:"chat_body",children:w.map((function(e){var t;return Object(y.jsxs)("p",{className:"chat_message ".concat(e.name===E.displayName&&"chat_receiver"),children:[Object(y.jsx)("span",{className:"chat_name",children:e.name}),e.message,Object(y.jsx)("span",{className:"chat_timestemp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]},e.timestamp)}))}),Object(y.jsxs)("div",{className:"chat_footer",children:[Object(y.jsx)(u.a,{}),Object(y.jsxs)("form",{children:[Object(y.jsx)("input",{value:n,onChange:function(e){return i(e.target.value)},type:"text",placeholder:"Type a message"}),Object(y.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),N.collection("messages").add({message:n,name:E.displayName,uid1:O,uid2:m,timestamp:x.a.firestore.FieldValue.serverTimestamp()}),i("")},children:" Send a Message"})]}),Object(y.jsx)(b.a,{})]})]})]})},M=a(47),T=a.n(M),B=a(57),G=a(106);a(84);var L=function(){var e=Object(D.g)(),t=I().signInWithGoogle;function a(){return(a=Object(B.a)(T.a.mark((function a(){return T.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t();case 3:e.push("/"),a.next=9;break;case 6:a.prev=6,a.t0=a.catch(0),alert("Failed to Login");case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))).apply(this,arguments)}return Object(y.jsx)("div",{className:"login",children:Object(y.jsxs)("div",{className:"login_container",children:[Object(y.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg",alt:""}),Object(y.jsx)("div",{className:"login_text",children:Object(y.jsx)("h1",{children:"Sign in to Whatsapp"})}),Object(y.jsx)(G.a,{type:"submit",onClick:function(){return a.apply(this,arguments)},children:"Sign in With Google"})]})})},R=a(43),W=a(58);function P(e){var t=e.component,a=Object(W.a)(e,["component"]),c=I().currentUser;return Object(y.jsx)(D.b,Object(R.a)(Object(R.a)({},a),{},{render:function(e){return c?Object(y.jsx)(t,Object(R.a)({},e)):Object(y.jsx)(D.a,{to:"/login"})}}))}var F=function(){return Object(y.jsx)("div",{className:"App",children:Object(y.jsx)(S.a,{children:Object(y.jsx)(U,{children:Object(y.jsxs)(D.d,{children:[Object(y.jsx)(P,{path:"/users/:senderId/:userId",component:A}),Object(y.jsx)(P,{path:"/rooms/:roomId",component:E}),Object(y.jsx)(P,{exact:!0,path:"/",component:E}),Object(y.jsx)(D.b,{path:"/login",component:L})]})})})})};i.a.render(Object(y.jsx)(s.a.StrictMode,{children:Object(y.jsx)(F,{})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.3fadbd74.chunk.js.map
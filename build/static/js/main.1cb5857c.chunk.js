(this["webpackJsonpmy-whatsapp"]=this["webpackJsonpmy-whatsapp"]||[]).push([[0],{54:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},87:function(e,t,a){},89:function(e,t,a){"use strict";a.r(t);var c=a(2),s=a.n(c),n=a(35),i=a.n(n),r=(a(73),a(74),a(18)),o=a(108),d=a(102),l=a(103),j=a(104),u=a(105),m=a(106),h=(a(54),a(75),a(76),a(30)),b=h.a.initializeApp({apiKey:"AIzaSyDNdMRue_sxo4B6kwb4dFk2oY2GNvrgphI",authDomain:"my-whatsapp-aec72.firebaseapp.com",projectId:"my-whatsapp-aec72",storageBucket:"my-whatsapp-aec72.appspot.com",messagingSenderId:"283307162217",appId:"1:283307162217:web:1f1452b6e7227d51e400f8",measurementId:"G-0222V19JY6"}),p=b.firestore(),O=b.auth(),f=(new h.a.auth.GoogleAuthProvider,b.storage()),x=p,g=a(32),v=a(4);var N=function(e){var t,a=e.userid,s=e.roomid,n=e.name,i=e.addNewChat,d=e.profileImage,l=e.currentUser,j=Object(c.useState)(""),u=Object(r.a)(j,2),m=u[0],h=u[1],b=Object(c.useState)(""),p=Object(r.a)(b,2),O=p[0],f=p[1];return Object(c.useEffect)((function(){s?x.collection("rooms").doc(s).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){f(e.docs.map((function(e){return e.data()})))})):a&&x.collection("users").doc(a).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){f(e.docs.map((function(e){return e.data()})))}))}),[s,a]),Object(c.useEffect)((function(){h(Math.floor(5e3*Math.random()))}),[]),i?Object(v.jsx)("div",{onClick:function(){var e=prompt("Please Enter Name for Chat");e&&x.collection("rooms").add({name:e,seed:Math.floor(5e3*Math.random())})},className:"sidebarChat",children:Object(v.jsx)("h3",{className:"add-new-chat-title",children:"Add New Chat"})}):a?Object(v.jsx)(g.b,{to:"/users/".concat(l,"/").concat(a),children:Object(v.jsxs)("div",{className:"sidebarChat",children:[Object(v.jsx)(o.a,{src:d}),Object(v.jsxs)("div",{className:"sidebarChat_info",children:[Object(v.jsx)("h2",{children:n}),Object(v.jsx)("p",{children:null===(t=O[0])||void 0===t?void 0:t.message})]})]})},a):s?Object(v.jsx)(g.b,{to:"/rooms/".concat(s),children:Object(v.jsxs)("div",{className:"sidebarChat",children:[Object(v.jsx)(o.a,{src:"https://avatars.dicebear.com/api/human/".concat(m,".svg")}),Object(v.jsx)("div",{className:"sidebarChat_info",children:Object(v.jsx)("h2",{children:n})})]})},s):void 0},y=a(61),S=s.a.createContext();function w(){return Object(c.useContext)(S)}function _(e){var t=e.children,a=Object(c.useState)(),s=Object(r.a)(a,2),n=s[0],i=s[1],o=Object(c.useState)(!0),d=Object(r.a)(o,2),l=d[0],j=d[1];Object(c.useEffect)((function(){return O.onAuthStateChanged((function(e){i(e),j(!1)}))}),[]);var u={currentUser:n,logout:function(){return O.signOut()},signInWithGoogle:function(){var e=new y.a.auth.GoogleAuthProvider;return O.signInWithPopup(e).then((function(e){x.collection("users").doc(e.user.uid).set({name:e.user.displayName,uid:e.user.uid,profileUrl:e.user.photoURL,createdAt:new Date})}))}};return Object(v.jsx)(S.Provider,{value:u,children:!l&&t})}var C=function(e){var t=Object(c.useState)([]),a=Object(r.a)(t,2),s=a[0],n=a[1],i=Object(c.useState)([]),d=Object(r.a)(i,2),l=d[0],j=d[1],u=w().currentUser;return Object(c.useEffect)((function(){var e=x.collection("rooms").onSnapshot((function(e){return n(e.docs.map((function(e){return{id:e.id,data:e.data()}})))})),t=x.collection("users").onSnapshot((function(e){return j(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e(),t()}}),[]),Object(v.jsxs)("div",{className:"sidebar",children:[Object(v.jsxs)("div",{className:"sidebar_header",children:[Object(v.jsx)(o.a,{src:null===u||void 0===u?void 0:u.photoURL}),Object(v.jsx)("div",{className:"sidebar_headerRight",children:u.displayName})]}),Object(v.jsx)("hr",{}),Object(v.jsxs)("div",{className:"sidebar_chats",children:[Object(v.jsx)(N,{addNewChat:!0}),Object(v.jsx)("hr",{}),l.map((function(e){return u.uid!==e.id&&Object(v.jsx)(N,{userid:e.id,name:e.data.name,profileImage:e.data.profileUrl,currentUser:u.uid},e.id)})),s.map((function(e){return Object(v.jsx)(N,{roomid:e.id,name:e.data.name},e.id)}))]})]})},k=a(14),I=function(e,t,a,c){a?f.ref("/files/".concat(t.uid,"/").concat(e.name)).put(e).snapshot.ref.getDownloadURL().then((function(e){x.collection("rooms").doc(a).collection("messages").add({type:"file",message:e,name:t.displayName,timestamp:h.a.firestore.FieldValue.serverTimestamp()})})):f.ref("/files/".concat(t.uid,"/").concat(e.name)).put(e).snapshot.ref.getDownloadURL().then((function(e){x.collection("messages").add({type:"file",message:e,name:t.displayName,uid1:c,uid2:t.uid,timestamp:h.a.firestore.FieldValue.serverTimestamp()})}))},D=a(46);var U=function(){var e=Object(c.useRef)(null),t=Object(c.useState)(""),a=Object(r.a)(t,2),s=a[0],n=a[1],i=Object(c.useState)(""),b=Object(r.a)(i,2),p=(b[0],b[1],Object(k.h)().roomId),O=Object(c.useState)({}),f=Object(r.a)(O,2),g=f[0],N=f[1],y=Object(c.useState)([]),S=Object(r.a)(y,2),_=S[0],U=S[1],E=w(),R=E.currentUser,A=E.logout,B=Object(c.useState)(!1),G=Object(r.a)(B,2),F=G[0],M=G[1];return Object(c.useEffect)((function(){p&&(x.collection("rooms").doc(p).onSnapshot((function(e){N(e.data())})),x.collection("rooms").doc(p).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){U(e.docs.map((function(e){return e.data()})))})))}),[p]),Object(v.jsxs)("div",{className:"app_body",children:[Object(v.jsx)(C,{}),Object(v.jsxs)("div",{className:"chat",children:[Object(v.jsxs)("div",{className:"chat_header",children:[Object(v.jsx)(o.a,{src:"https://avatars.dicebear.com/api/human/".concat(g.seed,".svg")}),Object(v.jsx)("div",{className:"chat_headerInfo",children:Object(v.jsx)("h3",{className:"chat-room-name",children:g.name})}),Object(v.jsxs)("div",{className:"chat_headerRight",children:[Object(v.jsx)("input",{type:"file",ref:e,style:{visibility:"hidden"},onChange:function(e){e.preventDefault();var t=e.target.files[0];I(t,R,p)}}),Object(v.jsx)(d.a,{children:Object(v.jsx)(l.a,{onClick:function(){return e.current.click()}})}),Object(v.jsx)(d.a,{onClick:A,children:Object(v.jsx)(j.a,{})})]})]}),Object(v.jsx)("div",{className:"chat_body",children:_.map((function(e){return Object(v.jsxs)("p",{className:"chat_message ".concat(e.name===R.displayName&&"chat_receiver"),children:[Object(v.jsx)("span",{className:"chat_name",children:e.name}),"message"===e.type?e.message:Object(v.jsx)("img",{src:e.message,alt:"failed to load"}),"message"===e.type&&Object(v.jsxs)("span",{className:"chat_timestemp",children:[e.timestamp&&new Date(1e3*e.timestamp.seconds).toString().substring(16,21),"\xa0\xa0",e.timestamp&&new Date(1e3*e.timestamp.seconds).toString().substring(4,10)]})]},e.timestamp)}))}),Object(v.jsxs)("div",{className:"chat_footer",children:[Object(v.jsx)(d.a,{onClick:function(e){M((function(e){return!e}))},children:Object(v.jsx)(u.a,{})}),F?Object(v.jsx)(D.a,{onSelect:function(e){var t=e.native;n(s+t)},emoji:"wink",skin:"2",set:"google",color:"#25D366",title:"Select the Emoji",style:{position:"absolute",bottom:"85px",width:"60%"}}):null,Object(v.jsxs)("form",{children:[Object(v.jsx)("input",{value:s,onChange:function(e){return n(e.target.value)},type:"text",placeholder:"Type a message"}),Object(v.jsx)(d.a,{type:"submit",onClick:function(e){e.preventDefault(),s&&x.collection("rooms").doc(p).collection("messages").add({type:"message",message:s,name:R.displayName,timestamp:h.a.firestore.FieldValue.serverTimestamp()}),n("")},children:Object(v.jsx)(m.a,{className:"send"})})]})]})]})]})};var E=function(){var e=Object(c.useRef)(null),t=Object(c.useState)(""),a=Object(r.a)(t,2),s=a[0],n=a[1],i=Object(k.h)(),b=i.userId,p=i.senderId,O=Object(c.useState)(""),f=Object(r.a)(O,2),g=f[0],N=f[1],y=Object(c.useState)([]),S=Object(r.a)(y,2),_=S[0],U=S[1],E=w(),R=E.currentUser,A=E.logout,B=Object(c.useState)(!1),G=Object(r.a)(B,2),F=G[0],M=G[1];return Object(c.useEffect)((function(){b&&(x.collection("users").doc(b).onSnapshot((function(e){N(e.data())})),x.collection("messages").where("uid1","in",[b,p]).orderBy("timestamp","asc").onSnapshot((function(e){var t=[];e.forEach((function(e){(e.data().uid1===b&&e.data().uid2===p||e.data().uid1===p&&e.data().uid2===b)&&t.push(e.data())})),U(t)})))}),[b,p]),Object(v.jsxs)("div",{className:"app_body",children:[Object(v.jsx)(C,{}),Object(v.jsxs)("div",{className:"chat",children:[Object(v.jsxs)("div",{className:"chat_header",children:[Object(v.jsx)(o.a,{src:g.profileUrl}),Object(v.jsx)("div",{className:"chat_headerInfo",children:Object(v.jsx)("h3",{className:"chat-room-name",children:g.name})}),Object(v.jsxs)("div",{className:"chat_headerRight",children:[Object(v.jsx)("input",{type:"file",ref:e,style:{visibility:"hidden"},onChange:function(e){e.preventDefault();var t=e.target.files[0];I(t,R,p)}}),Object(v.jsx)(d.a,{children:Object(v.jsx)(l.a,{onClick:function(){return e.current.click()}})}),Object(v.jsx)(d.a,{onClick:A,children:Object(v.jsx)(j.a,{})})]})]}),Object(v.jsx)("div",{className:"chat_body",children:_.map((function(e){return Object(v.jsxs)("p",{className:"chat_message ".concat(e.name===R.displayName&&"chat_receiver"),children:[Object(v.jsx)("span",{className:"chat_name",children:e.name}),"message"===e.type?e.message:Object(v.jsx)("img",{src:e.message,alt:"failed to load"}),"message"===e.type&&Object(v.jsxs)("span",{className:"chat_timestemp",children:[e.timestamp&&new Date(1e3*e.timestamp.seconds).toString().substring(16,21),"\xa0\xa0",e.timestamp&&new Date(1e3*e.timestamp.seconds).toString().substring(4,10)]})]},e.timestamp)}))}),Object(v.jsxs)("div",{className:"chat_footer",children:[Object(v.jsx)(d.a,{onClick:function(e){M((function(e){return!e}))},children:Object(v.jsx)(u.a,{})}),F?Object(v.jsx)(D.a,{onSelect:function(e){var t=e.native;n(s+t)},emoji:"wink",skin:"2",set:"google",color:"#25D366",title:"Select the Emoji",style:{position:"absolute",bottom:"85px",width:"60%"}}):null,Object(v.jsxs)("form",{children:[Object(v.jsx)("input",{value:s,onChange:function(e){return n(e.target.value)},type:"text",placeholder:"Type a message"}),Object(v.jsx)(d.a,{type:"submit",onClick:function(e){e.preventDefault(),x.collection("messages").add({message:s,name:R.displayName,uid1:p,uid2:b,timestamp:h.a.firestore.FieldValue.serverTimestamp()}),n("")},children:Object(v.jsx)(m.a,{className:"send"})})]})]})]})]})},R=a(53),A=a.n(R),B=a(62),G=a(107);a(87);var F=function(){var e=Object(k.g)(),t=w().signInWithGoogle;function a(){return(a=Object(B.a)(A.a.mark((function a(){return A.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t();case 3:e.push("/"),a.next=9;break;case 6:a.prev=6,a.t0=a.catch(0),alert("Failed to Login");case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))).apply(this,arguments)}return Object(v.jsx)("div",{className:"login",children:Object(v.jsxs)("div",{className:"login_container",children:[Object(v.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg",alt:""}),Object(v.jsx)("div",{className:"login_text",children:Object(v.jsx)("h1",{children:"Sign in to Whatsapp"})}),Object(v.jsx)(G.a,{type:"submit",onClick:function(){return a.apply(this,arguments)},children:"Sign in With Google"})]})})},M=a(47),T=a(63);function W(e){var t=e.component,a=Object(T.a)(e,["component"]),c=w().currentUser;return Object(v.jsx)(k.b,Object(M.a)(Object(M.a)({},a),{},{render:function(e){return c?Object(v.jsx)(t,Object(M.a)({},e)):Object(v.jsx)(k.a,{to:"/login"})}}))}a(88);var L=function(){return Object(v.jsx)("div",{className:"App",children:Object(v.jsx)(g.a,{children:Object(v.jsx)(_,{children:Object(v.jsxs)(k.d,{children:[Object(v.jsx)(W,{path:"/users/:senderId/:userId",component:E}),Object(v.jsx)(W,{path:"/rooms/:roomId",component:U}),Object(v.jsx)(W,{exact:!0,path:"/",component:U}),Object(v.jsx)(k.b,{path:"/login",component:F})]})})})})};i.a.render(Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(L,{})}),document.getElementById("root"))}},[[89,1,2]]]);
//# sourceMappingURL=main.1cb5857c.chunk.js.map